<!DOCTYPE html>

<html> 

<head>    
    <link rel="stylesheet" type="text/css" href="jxgi_site_design.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Portfolio</title> 
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <style>
        #chartGrid {
            display: flex;
        }     
    </style>
</head>

<body> 
    
    <div class="header">
      <div class="header-text">
        <h1 class="big" style="margin-bottom: 0px;">
          Juan Xavier Gomez Illingworth
        </h1>
        <p style="margin-top: 0px; color: darkblue">
          <a href="JXGI CV 09-2025.pdf">CV</a> | 
          <a href="https://www.linkedin.com/in/juan-xavier-gomez-illingworth">LinkedIn</a> | 
          <a href="https://www.github.com/YOUR_GITHUB">GitHub</a>
        </p>
      </div>
      <img src="images/jxgi_photo.jpg" alt="My photo" class="profile-pic">
    </div>

    <hr>
    
    <div class="header">
        <h3 class="small"> 
            Hello and welcome! This space mostly contains schoolwork, information I find interesting, and random data. Feel free to get in touch with me through one of the links above!
        </h3>
    </div>
    <div class="header">
        <h4>  
            - Juan
        </h4>
    </div>
        
    <nav>
      <div class="menu-toggle" id="menuToggle">
        <span>â˜°</span>
      </div>
      <ul id="navMenu">
        <li><a href="#schoolwork">Schoolwork</a>
          <ul class="dropdown">
            <li><a href="#pp434">PP434</a>
              <ul class="dropdown">
                <li><a href="#coding">Coding Challenges</a>
                  <ul class="dropdown">
                    <li><a href="#cc1">Coding Challenge 1</a></li>
                    <li><a href="#cc2">Coding Challenge 2</a></li>
                    <li><a href="#cc3">Coding Challenge 3</a></li>
                    <li><a href="#cc4">Coding Challenge 4</a></li>
                    <li><a href="#cc5">Coding Challenge 5</a></li>
                    <li><a href="#cc6">Coding Challenge 6</a></li>
                    <li><a href="#cc7">Coding Challenge 7</a></li>
                    <li><a href="#cc8">Coding Challenge 8</a></li>
                    <li><a href="#cc8">Coding Challenge 9</a></li>
                    <li><a href="#cc8">Coding Challenge 10</a></li>
                  </ul>
                </li>
                <li><a href="#final">Final Project</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#about">About Me</a></li>
      </ul>
    </nav>

    <div id="cc4">

        <h3>Schoolwork | PP434 | Coding Challenges | Coding Challenge 4</h3>
        <h2>Replication. Re-create, then improve, someone elseâ€™s chart.</h2>
        <hr>
        
        <section>
            <div class="chart-description">
                <h5>Week 4: TFR API Live Chart</h5>
                <p> 
                    We've organised the page into sections, with each section containing a chart, title and a description. Here, we can describe the chart and give some context.
                    As a first example, we're using a basic chart from our repo.
                </p>
            </div>
            <figure id="Location7"></figure> 
        </section>

    </div>
        
    <div id="cc3">

        <h3>Schoolwork | PP434 | Coding Challenges | Coding Challenge 3</h3>
        <h2>Debate. Use a visualisation in policy commentary.</h2>
        <hr>
        
        <section>
            <div class="chart-description">
                <h5>Week 3: Python / Altair chart</h5>
                <p> 
                    We've organised the page into sections, with each section containing a chart, title and a description. Here, we can describe the chart and give some context.
                    As a first example, we're using a basic chart from our repo.
                </p>
            </div>
            <figure id="Location5"></figure> 
        </section>

    </div>

    <div id="cc2">

        <h3>Schoolwork | PP434 | Coding Challenges | Coding Challenge 2</h3>
        <h2>Building. Create your own visualisations.</h2>
        <hr>
        
        <section>
            <div class="chart-description">
                <h5>USA Productivity Index (Economics Observatory Chart)</h5>
                <p> 
                    The chart shows the USA productivity index over time since the late 1940s, with 2012 as the reference year. 
                    It was built using the "Create" tool from the Economics Observatory (see <span class="hover-image-container"><span class="hover-trigger">specifications</span><img src="images/eco_obs_create_1.png" alt="Specifications" class="hover-image" style="max-width: 400px;"></span>).
                </p>
            </div>
            <figure id="Location3"></figure> 
        </section>
    
        <section>
            <div class="chart-description">
                <h5>USA Weekly Wage</h5>
                <p> 
                    The chart shows the USA real weekly wage over time since the late 1970s (1982-84 CPI Adj.). 
                    It was built using the "Create" tool from the Economics Observatory (see <span class="hover-image-container"><span class="hover-trigger">specifications</span><img src="images/eco_obs_create_2.png" alt="Specifications" class="hover-image" style="max-width: 400px;"></span>).
                </p>
            </div>
            <figure id="Location4"></figure> 
        </section>
        
    </div>
    
    <div id="cc1">

        <h3>Schoolwork | PP434 | Coding Challenges | Coding Challenge 1</h3>
        <h2>Hosting. Display charts in your own site.</h2>
        <hr>
        
        <section>
            <div class="chart-description">
                <h5>Fertility Rate Vs. GDP per Capita in the UK</h5>
                <p> 
                    In this graph I combined two data series obtained through the World Bank API. Even though they were on different scales, 
                    I made sure that both axes were aligned so that, for example, the number 3 on the Fertility Rate axis corresponds to the 
                    number 30,000 on the GDP per Capita axis. I formatted the GDP per Capita numbers to use a "," as a thousands separator, 
                    including those in the tooltip.
                </p>
            </div>
            <figure id="Location1"></figure> 
        </section>
    
        <section>
             <div class="chart-description">
                <h5>Unemployment Rate in the UK Vs. in Other Countries</h5>
                <p> 
                    In this chart I plotted the same series obtained through the World Bank API for various countries. Given that the chart 
                    looks a bit crowded, I added the functionality to isolate a line by clicking on it using a condition inside the opacity 
                    property. Unfortunately, this functionality from VegaLite does not appear to function so well on a mobile browser.
                </p>
            </div>
            <figure id="Location2"></figure>
        </section>
    
    </div>
    
    <!-- Modal for zoomed chart -->
    <div id="chartModal" class="chart-modal">
        <span class="close-btn">&times;</span>
        <div class="chart-modal-content">
            <div id="modalChart"></div>
        </div>
    </div>
    
    <script>

        let figure_1_spec = "graphs/fertility_gdppc_uk.json";                                                                                                                   
        let figure_2_spec = "graphs/uk_other_unemp_rates.json";
        let figure_3_spec = "graphs/usa_productivity.json";
        let figure_4_spec = "graphs/usa_weekly_wages.json";
        let figure_5_spec = "graphs/eu_co2_targets.html";
        let figure_6_spec = "shiller_pe_ratio_chart (1).json";
        let figure_7_spec = "TFR_live_chart.json";
        
        let embedOpt = {
            actions: false,
            renderer: "canvas"
        };
        
        // Chart zoom functionality
        const chartSpecs = {
            'Location1': figure_1_spec,
            'Location2': figure_2_spec,
            'Location3': figure_3_spec,
            'Location4': figure_4_spec,
            'Location5': figure_5_spec,
            'Location6': figure_6_spec,
            'Location7': figure_7_spec
        };
        
        // Function to add zoom button to a figure
        function addZoomButton(locationId, chartSpec) {
            const figure = document.getElementById(locationId);
            if (figure) {
                const zoomBtn = document.createElement('button');
                zoomBtn.className = 'zoom-btn';
                zoomBtn.innerHTML = 'ðŸ” Zoom';
                zoomBtn.onclick = () => openChartModal(chartSpec);
                figure.appendChild(zoomBtn);
            }
        }
        
        // Function to load chart (handles both JSON and HTML files)
        function loadChart(locationId, chartSpec) {
            const figure = document.getElementById(locationId);
            if (chartSpec.endsWith('.html')) {
                // For HTML files (like Plotly), use iframe
                const iframe = document.createElement('iframe');
                iframe.src = chartSpec;
                iframe.style.width = '100%';
                iframe.style.height = '500px';
                iframe.style.border = 'none';
                figure.appendChild(iframe);
                addZoomButton(locationId, chartSpec);
            } else {
                // For JSON files (Vega-Lite), use vegaEmbed
                vegaEmbed('#' + locationId, chartSpec, embedOpt).then(() => addZoomButton(locationId, chartSpec));
            }
        }
        
        loadChart('Location1', figure_1_spec);
        loadChart('Location2', figure_2_spec);
        loadChart('Location3', figure_3_spec);
        loadChart('Location4', figure_4_spec);
        loadChart('Location5', figure_5_spec);
        loadChart('Location6', figure_6_spec);
        loadChart('Location7', figure_7_spec);
        
        const modal = document.getElementById('chartModal');
        const closeBtn = document.querySelector('.close-btn');
        
        function openChartModal(chartSpec) {
            modal.classList.add('active');
            const modalChart = document.getElementById('modalChart');
            
            // Calculate responsive dimensions for both chart types
            let chartWidth = 900;
            let chartHeight = 600;
            
            if (window.innerWidth <= 600) {
                chartWidth = window.innerWidth * 0.9;
                chartHeight = window.innerHeight * 0.6;
            } else if (window.innerWidth <= 900) {
                chartWidth = window.innerWidth * 0.85;
                chartHeight = window.innerHeight * 0.7;
            }
            
            if (chartSpec.endsWith('.html')) {
                // For HTML files, use iframe with responsive sizing
                const iframe = document.createElement('iframe');
                iframe.src = chartSpec;
                iframe.style.width = chartWidth + 'px';
                iframe.style.height = chartHeight + 'px';
                iframe.style.border = 'none';
                modalChart.appendChild(iframe);
            } else {
                // For JSON files, use vegaEmbed with responsive sizing
                const largeEmbedOpt = {
                    actions: true,
                    renderer: "canvas",
                    width: chartWidth,
                    height: chartHeight,
                    tooltip: {offsetX: 5, offsetY: 5}
                };
                vegaEmbed('#modalChart', chartSpec, largeEmbedOpt);
            }
        }
        
        closeBtn.onclick = function() {
            modal.classList.remove('active');
            document.getElementById('modalChart').innerHTML = '';
        }
        
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.classList.remove('active');
                document.getElementById('modalChart').innerHTML = '';
            }
        }
        
        // Mobile menu toggle
        const menuToggle = document.getElementById('menuToggle');
        const navMenu = document.getElementById('navMenu');
        
        menuToggle.onclick = function() {
            navMenu.classList.toggle('active');
        }
        
        // Handle dropdown toggles on mobile
        if (window.innerWidth <= 768) {
            document.querySelectorAll('nav li > a').forEach(link => {
                const parentLi = link.parentElement;
                const dropdown = parentLi.querySelector('ul.dropdown');
                
                if (dropdown) {
                    link.addEventListener('click', function(e) {
                        // Only prevent default if there's a dropdown
                        if (!link.getAttribute('href').startsWith('#') || link.getAttribute('href') === '#schoolwork' || link.getAttribute('href') === '#pp434' || link.getAttribute('href') === '#coding') {
                            e.preventDefault();
                            parentLi.classList.toggle('active');
                        }
                    });
                }
            });
        }
        
        // Close menu when clicking a final destination link on mobile
        document.querySelectorAll('nav a').forEach(link => {
            link.addEventListener('click', function() {
                const parentLi = link.parentElement;
                const dropdown = parentLi.querySelector('ul.dropdown');
                
                // Only close menu if it's a final link (no dropdown)
                if (!dropdown && window.innerWidth <= 768) {
                    navMenu.classList.remove('active');
                }
            });
        });
        
    </script>

</body>
    
</html>
