<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICE Arrests Flipbook</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            background-color: #ffffff;
            margin: 0;
            padding: 0;
        }

        .flipbook-container {
            width: 100%;
            max-width: 100%;
            background: white;
            display: flex;
            flex-direction: column;
            height: 100vh;
            min-height: 400px;
        }

        .page-display {
            width: 100%;
            flex: 1;
            position: relative;
            background: white;
            min-height: 0;
            overflow: hidden;
        }

        .page {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            display: flex;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
        }
        
        .iframe-wrapper {
            width: 100%;
            height: 100%;
            max-width: none;
            max-height: none;
            position: relative;
        }

        .page.active {
            opacity: 1;
            z-index: 1;
        }

        .page img {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
        }

        .page iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px 15px;
            background: #f8f8f8;
            border-top: 1px solid #e0e0e0;
            gap: 15px;
        }

        .nav-button {
            padding: 6px 12px;
            background: #4259AA;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            font-family: 'Roboto', Arial, sans-serif;
            transition: background 0.3s ease;
            white-space: nowrap;
        }

        .nav-button:hover:not(:disabled) {
            background: #354a8f;
        }

        .nav-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .page-indicator {
            font-size: 13px;
            color: #333;
            font-weight: 500;
        }

        .page-dots {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #ddd;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.3s ease;
        }

        .dot.active {
            background: #4259AA;
            transform: scale(1.3);
        }

        .page-title {
            position: absolute;
            top: 10px;
            left: 20px;
            font-size: 14px;
            color: #666;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 10px;
            border-radius: 4px;
            z-index: 10;
        }

        @media (max-width: 480px) {
            .page-display {
                height: 400px;
            }

            .controls {
                flex-direction: column;
                gap: 10px;
            }

            .nav-button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="flipbook-container">
        <div class="page-display">
            <div class="page active" id="page1">
                <div class="page-title">Page 1: Original Chart</div>
                <img src="../images/ice_migrant_arrests_economist.png" alt="ICE Migrant Arrests - Original Chart">
            </div>
            <div class="page" id="page2">
                <div class="page-title">Page 2: Replicated Original Chart</div>
                <div class="iframe-wrapper">
                    <iframe src="ice_migrant_arrests_economist.html"></iframe>
                </div>
            </div>
            <div class="page" id="page3">
                <div class="page-title">Page 3: Modified Original Chart</div>
                <div class="iframe-wrapper">
                    <iframe src="ice_migrant_arrests_economist_modified.html"></iframe>
                </div>
            </div>
        </div>
        <div class="controls">
            <button class="nav-button" id="prevBtn" onclick="previousPage()">← Previous</button>
            <div class="page-indicator">
                Page <span id="currentPage">1</span> of 3
            </div>
            <div class="page-dots">
                <div class="dot active" onclick="goToPage(1)"></div>
                <div class="dot" onclick="goToPage(2)"></div>
                <div class="dot" onclick="goToPage(3)"></div>
            </div>
            <button class="nav-button" id="nextBtn" onclick="nextPage()">Next →</button>
        </div>
    </div>

    <script>
        let currentPage = 1;
        const totalPages = 3;

        function updateDisplay() {
            // Update page visibility
            for (let i = 1; i <= totalPages; i++) {
                const page = document.getElementById(`page${i}`);
                if (i === currentPage) {
                    page.classList.add('active');
                } else {
                    page.classList.remove('active');
                }
            }

            // Update dots
            const dots = document.querySelectorAll('.dot');
            dots.forEach((dot, index) => {
                if (index + 1 === currentPage) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });

            // Update page number
            document.getElementById('currentPage').textContent = currentPage;

            // Update button states
            document.getElementById('prevBtn').disabled = currentPage === 1;
            document.getElementById('nextBtn').disabled = currentPage === totalPages;
        }

        function nextPage() {
            if (currentPage < totalPages) {
                currentPage++;
                updateDisplay();
            }
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                updateDisplay();
            }
        }

        function goToPage(pageNum) {
            if (pageNum >= 1 && pageNum <= totalPages) {
                currentPage = pageNum;
                updateDisplay();
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                previousPage();
            } else if (e.key === 'ArrowRight') {
                nextPage();
            }
        });

        // Detect if embedded in small iframe and apply zoom
        function checkAndApplyZoom() {
            // Check if we're in an iframe that's smaller than our content
            const isInIframe = window.self !== window.top;
            const containerHeight = window.innerHeight;
            
            // Apply zoom only if embedded in a small container (height < 600px)
            const iframes = document.querySelectorAll('.page iframe');
            if (isInIframe && containerHeight < 600) {
                iframes.forEach(iframe => {
                    iframe.style.zoom = '0.70';
                });
            } else {
                // Remove zoom for modal view
                iframes.forEach(iframe => {
                    iframe.style.zoom = '1.0';
                });
            }
        }

        // Initialize
        updateDisplay();
        checkAndApplyZoom();
        
        // Recheck on window resize
        window.addEventListener('resize', checkAndApplyZoom);
    </script>
</body>
</html>
